<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<link rel="stylesheet" href="./css/bootstrap.min.css">
<title>Translater</title>
</head>
<body>
  <div class="container">
    <div class="my-3 ps-3 fs-3 fw-bold">언어 선택</div>
      <div class="row">
        <div class="col pe-0">
          <select class="form-select" id="dd">
            <option value="ko">한국어</option>
            <option value="en">영어</option>
          </select>
        </div>
        <div class="col ps-0">
          <select class="form-select" id="ff">
            <option value="ko">한국어</option>
            <option value="en">영어</option>
          </select>
        </div>
      </div>

    <div class="row">
      <div class="col pe-0">
        <input class="form-control" style="height: 300px !important;" type="text" onkeydown="enterkey()" id="trans_word" placeholder="번역할 내용을 입력해주세요">
      </div>
      <div class="col ps-0">
        <div class="form-control" style="height: 300px !important" id="outprint"></div>
      </div>
    </div>
    <div class="row ms-0 me-0">
      <button class="btn btn-light ps-10" style="width: 1300px; height: 45px;" onClick = "send_translate()">번역</button>
    </div>
  </div>  
</body>

<script>
  function enterkey(){
    if (window.event.keyCode == 13){
      let formData = new FormData();
      let opt = document.getElementById('dd').value;
      let opt2 = document.getElementById('ff');
      let trans_word = document.getElementById('trans_word').value;

      if(opt === opt2.value) {
        alert("변경될 언어가 잘못 선택되었습니다.");
        if (opt === "ko"){
          opt2.value = 'en'
          return;
        }else{
          opt2.value = 'ko'
          return;
        }
      }

    formData.append("text", trans_word);
    
    if (opt == 'ko') {
        formData.append("lang", 'ko');    
        let url = "http://127.0.0.1:5000/trans_ko";
        send_msg(url, formData);
    }
    else if(opt == 'en') {
        formData.append("lang", 'en');
        let url = "http://127.0.0.1:5000/trans_en";
        send_msg(url, formData);
    
    }
  };
}

  function send_translate() {
    let formData = new FormData();
    let opt = document.getElementById('dd').value;
    let opt2 = document.getElementById('ff');
    let trans_word = document.getElementById('trans_word').value;

    if(opt === opt2.value) {
      alert("변경될 언어가 잘못 선택되었습니다.");
      opt2.value = 'en'
      return;
    }

    formData.append("text", trans_word);
    
    if (opt == 'ko') {
        formData.append("lang", 'ko');    
        let url = "http://127.0.0.1:5000/trans_ko";
        send_msg(url, formData);
    }
    else if(opt == 'en') {
        formData.append("lang", 'en');
        let url = "http://127.0.0.1:5000/trans_en";
        send_msg(url, formData);
    
    }
  };

  function send_msg(url, data) {
      fetch(url, {
          headers: {
	          Accept: "application / json",
	      },
          method: "POST",
          body: data,
      })
      .then((res) => res.json())
      .then((data) => {
          console.log(data['text']);
          let d = document.getElementById("outprint");
          d.innerText = data['text'];
      });
  }
</script>

<style>
html{
  align-items: center;
}
select {
  width: 150px;
  height : 50px;
  margin: 0 auto;
  text-align : center;
}
</style>
</html>